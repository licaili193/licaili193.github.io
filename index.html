<!DOCTYPE html>

<html>
	<head>
		<meta charset="UTF-8">
		<title>我的房屋信息收集</title>
	</head>
	<body>
		<h1>我的房屋信息收集</h1>
        <style type="text/css">
		.tg  {border-collapse:collapse;border-color:#9ABAD9;border-spacing:0;}
		.tg td{background-color:#EBF5FF;border-color:#9ABAD9;border-style:solid;border-width:1px;color:#444;
		  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}
		.tg th{background-color:#409cff;border-color:#9ABAD9;border-style:solid;border-width:1px;color:#fff;
		  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
		.tg .tg-1wig{font-weight:bold;text-align:left;vertical-align:top}
		.tg .tg-0lax{text-align:left;vertical-align:top}
		</style>
		<table class="tg">
		<thead>
		  <tr>
			<th class="tg-1wig">序号</th>
			<th class="tg-1wig">地点</th>
			<th class="tg-1wig">价格</th>
			<th class="tg-1wig">是否上市</th>
			<th class="tg-1wig">详细资料</th>
		  </tr>
		</thead>
		<tbody id="gable">
		</tbody>
		</table>
	</body>
	<script>
        //first add an event listener for page load
        document.addEventListener( "DOMContentLoaded", get_json_data, false ); // get_json_data is the function name that will fire on page load

        //this function is in the event listener and will execute on page load
        function get_json_data(){
            // Relative URL of external json file
            var json_url = 'data.json';

            //Build the XMLHttpRequest (aka AJAX Request)
            xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() { 
                if (this.readyState == 4 && this.status == 200) {//when a good response is given do this

                    var data = JSON.parse(this.responseText); // convert the response to a json object
                    append_json(data);// pass the json object to the append_json function
                }
            }
            //set the request destination and type
            xmlhttp.open("POST", json_url, true);
            //set required headers for the request
            xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            // send the request
            xmlhttp.send(); // when the request completes it will execute the code in onreadystatechange section
        }

        //this function appends the json data to the table 'gable'
        function append_json(data){
            var table = document.getElementById('gable');
            data.forEach(function(object) {
                var tr = document.createElement('tr');
                tr.innerHTML = '<td>' + object.INDEX + '</td>' +
                '<td>' + object.LOCATION + '</td>' +
                '<td>' + object.PRICE + '</td>' +
                '<td>' + object.AVAILABLE + '</td>' +
				'<td>' + object.LINK + '</td>';
                table.appendChild(tr);
            });
        }
    </script>
</html>
